#include "myutils.h"
#include "features.h"
#include "dss.h"

// Keep this private, g_AlphaSizes2[] is for
//	fast, global access

double AA_S_ij[20][20] = {
   {      1.145,     0.3335,    -0.5222,    -0.1958,    -0.3484,   -0.01201,    -0.3032,    -0.1449,    -0.2829,    -0.1585,    0.05807,    -0.4555,    -0.3335,    -0.1833,    -0.2786,      0.165,   -0.05766,     0.1742,    -0.5551,    -0.4158, }, // 0
   {     0.3335,      2.926,     -1.369,     -1.416,    -0.1251,    -0.5832,     -0.501,    -0.0779,     -1.156,    -0.1569,   -0.01527,    -0.6152,     -1.146,    -0.9569,    -0.9347,    -0.1149,    -0.1316,     0.2889,    -0.7486,    -0.3152, }, // 1
   {    -0.5222,     -1.369,       1.61,     0.4882,     -1.504,    -0.2162,   -0.09713,     -1.734,    -0.1095,     -1.519,     -1.062,     0.4632,     -0.231,    0.06098,    -0.2362,     0.1078,    -0.1749,     -1.462,     -1.348,     -1.091, }, // 2
   {    -0.1958,     -1.416,     0.4882,      1.196,     -1.288,    -0.6008,   -0.07243,     -1.238,     0.2939,     -1.099,    -0.7389,   -0.07502,    -0.2556,     0.4815,     0.1536,     -0.019,    -0.1379,    -0.9514,     -1.014,    -0.8453, }, // 3
   {    -0.3484,    -0.1251,     -1.504,     -1.288,      1.726,     -1.122,    -0.1373,     0.3341,     -1.159,     0.4696,     0.3595,     -0.973,     -1.047,    -0.8931,    -0.8396,    -0.8087,    -0.5456,     0.1979,     0.8014,      0.967, }, // 4
   {   -0.01201,    -0.5832,    -0.2162,    -0.6008,     -1.122,      1.953,    -0.4411,     -1.524,    -0.5338,     -1.409,    -0.9063,    0.09466,    -0.4317,    -0.5199,    -0.5941,    0.06585,    -0.5275,     -1.126,     -1.184,     -1.003, }, // 5
   {    -0.3032,     -0.501,   -0.09713,   -0.07243,    -0.1373,    -0.4411,      2.053,     -0.755,   -0.04609,    -0.6053,    -0.3631,     0.2991,    -0.5836,     0.1917,     0.1511,   -0.04165,    -0.1323,    -0.5857,    -0.1762,      0.394, }, // 6
   {    -0.1449,    -0.0779,     -1.734,     -1.238,     0.3341,     -1.524,     -0.755,      1.409,     -1.036,     0.7486,     0.5142,     -1.328,    -0.9978,    -0.8557,    -0.8325,    -0.9321,    -0.3026,      1.046,    -0.3425,    -0.1778, }, // 7
   {    -0.2829,     -1.156,    -0.1095,     0.2939,     -1.159,    -0.5338,   -0.04609,     -1.036,      1.167,    -0.8873,    -0.5083,   -0.01363,    -0.2938,     0.4125,     0.6553,   -0.07283,    -0.1163,    -0.8217,     -1.054,     -0.724, }, // 8
   {    -0.1585,    -0.1569,     -1.519,     -1.099,     0.4696,     -1.409,    -0.6053,     0.7486,    -0.8873,      1.199,     0.6988,     -1.172,    -0.9894,    -0.7256,    -0.6898,    -0.9315,     -0.487,     0.5152,   -0.07358,   -0.07952, }, // 9
   {    0.05807,   -0.01527,     -1.062,    -0.7389,     0.3595,    -0.9063,    -0.3631,     0.5142,    -0.5083,     0.6988,      1.666,    -0.7066,    -0.8075,    -0.2418,    -0.4004,     -0.445,    -0.1486,     0.3261,   -0.05911,     0.0148, }, // 10
   {    -0.4555,    -0.6152,     0.4632,   -0.07502,     -0.973,    0.09466,     0.2991,     -1.328,   -0.01363,     -1.172,    -0.7066,      1.526,    -0.4051,    0.05261,   -0.05699,     0.2597,    0.04757,     -1.038,    -0.9274,    -0.5686, }, // 11
   {    -0.3335,     -1.146,     -0.231,    -0.2556,     -1.047,    -0.4317,    -0.5836,    -0.9978,    -0.2938,    -0.9894,    -0.8075,    -0.4051,      2.031,    -0.4692,    -0.4393,   -0.05469,    -0.3019,    -0.7271,     -1.054,    -0.9636, }, // 12
   {    -0.1833,    -0.9569,    0.06098,     0.4815,    -0.8931,    -0.5199,     0.1917,    -0.8557,     0.4125,    -0.7256,    -0.2418,    0.05261,    -0.4692,      1.056,     0.3807,    0.02222,   -0.03153,    -0.6841,    -0.7746,    -0.5136, }, // 13
   {    -0.2786,    -0.9347,    -0.2362,     0.1536,    -0.8396,    -0.5941,     0.1511,    -0.8325,     0.6553,    -0.6898,    -0.4004,   -0.05699,    -0.4393,     0.3807,      1.371,   -0.05883,   -0.02479,    -0.6894,    -0.6225,    -0.4145, }, // 14
   {      0.165,    -0.1149,     0.1078,     -0.019,    -0.8087,    0.06585,   -0.04165,    -0.9321,   -0.07283,    -0.9315,     -0.445,     0.2597,   -0.05469,    0.02222,   -0.05883,       1.14,     0.5462,    -0.6163,    -0.8097,    -0.5874, }, // 15
   {   -0.05766,    -0.1316,    -0.1749,    -0.1379,    -0.5456,    -0.5275,    -0.1323,    -0.3026,    -0.1163,     -0.487,    -0.1486,    0.04757,    -0.3019,   -0.03153,   -0.02479,     0.5462,      1.287,    0.01717,    -0.7016,    -0.4861, }, // 16
   {     0.1742,     0.2889,     -1.462,    -0.9514,     0.1979,     -1.126,    -0.5857,      1.046,    -0.8217,     0.5152,     0.3261,     -1.038,    -0.7271,    -0.6841,    -0.6894,    -0.6163,    0.01717,      1.357,    -0.3391,    -0.1692, }, // 17
   {    -0.5551,    -0.7486,     -1.348,     -1.014,     0.8014,     -1.184,    -0.1762,    -0.3425,     -1.054,   -0.07358,   -0.05911,    -0.9274,     -1.054,    -0.7746,    -0.6225,    -0.8097,    -0.7016,    -0.3391,      3.066,     0.8396, }, // 18
   {    -0.4158,    -0.3152,     -1.091,    -0.8453,      0.967,     -1.003,      0.394,    -0.1778,     -0.724,   -0.07952,     0.0148,    -0.5686,    -0.9636,    -0.5136,    -0.4145,    -0.5874,    -0.4861,    -0.1692,     0.8396,      1.863, }, // 19
 };

static double NENDist_S_ij[16][16] = {
   {      2.146,      1.605,      0.992,     0.5072,     0.1202,     -0.211,    -0.5549,     -1.046,     -1.369,     -1.623,     -1.752,     -1.982,      -2.14,     -2.389,     -2.883,      -3.67, }, // 0
   {      1.605,      1.893,      1.641,      1.011,     0.3702,    -0.1544,    -0.6532,     -1.194,     -1.493,     -1.855,     -1.946,     -2.152,     -2.334,     -2.555,      -3.13,     -3.784, }, // 1
   {      0.992,      1.641,      1.909,      1.437,     0.7509,     0.1266,    -0.4583,     -1.048,     -1.369,     -1.668,     -1.871,     -2.076,     -2.278,      -2.47,     -2.996,     -3.593, }, // 2
   {     0.5072,      1.011,      1.437,      1.614,      1.315,     0.7462,    0.01882,    -0.6019,    -0.9872,     -1.293,     -1.529,     -1.752,     -2.005,     -2.174,     -2.647,     -3.435, }, // 3
   {     0.1202,     0.3702,     0.7509,      1.315,      1.568,      1.272,     0.4512,    -0.2019,    -0.6141,     -0.979,     -1.209,      -1.45,     -1.708,     -1.886,     -2.347,      -3.16, }, // 4
   {     -0.211,    -0.1544,     0.1266,     0.7462,      1.272,      1.524,     0.9465,     0.2416,       -0.2,    -0.5652,    -0.8479,     -1.129,      -1.43,      -1.65,     -2.026,     -2.871, }, // 5
   {    -0.5549,    -0.6532,    -0.4583,    0.01882,     0.4512,     0.9465,      1.208,     0.8777,     0.4121,    0.02714,    -0.2952,    -0.6575,     -1.006,     -1.273,     -1.612,     -2.501, }, // 6
   {     -1.046,     -1.194,     -1.048,    -0.6019,    -0.2019,     0.2416,     0.8777,      1.192,     0.8932,     0.4898,     0.1097,    -0.2905,    -0.6807,     -1.029,     -1.363,     -2.282, }, // 7
   {     -1.369,     -1.493,     -1.369,    -0.9872,    -0.6141,       -0.2,     0.4121,     0.8932,      1.069,      0.847,     0.4904,     0.0519,    -0.3896,    -0.7766,     -1.187,     -2.137, }, // 8
   {     -1.623,     -1.855,     -1.668,     -1.293,     -0.979,    -0.5652,    0.02714,     0.4898,      0.847,      1.048,     0.8747,     0.4404,   -0.05207,     -0.479,    -0.8789,     -1.865, }, // 9
   {     -1.752,     -1.946,     -1.871,     -1.529,     -1.209,    -0.8479,    -0.2952,     0.1097,     0.4904,     0.8747,      1.117,     0.8679,     0.3661,   -0.09563,    -0.5428,     -1.605, }, // 10
   {     -1.982,     -2.152,     -2.076,     -1.752,      -1.45,     -1.129,    -0.6575,    -0.2905,     0.0519,     0.4404,     0.8679,      1.073,      0.813,     0.3735,    -0.1114,      -1.29, }, // 11
   {      -2.14,     -2.334,     -2.278,     -2.005,     -1.708,      -1.43,     -1.006,    -0.6807,    -0.3896,   -0.05207,     0.3661,      0.813,      1.083,     0.8748,     0.3399,    -0.9421, }, // 12
   {     -2.389,     -2.555,      -2.47,     -2.174,     -1.886,      -1.65,     -1.273,     -1.029,    -0.7766,     -0.479,   -0.09563,     0.3735,     0.8748,      1.246,     0.8754,    -0.5068, }, // 13
   {     -2.883,      -3.13,     -2.996,     -2.647,     -2.347,     -2.026,     -1.612,     -1.363,     -1.187,    -0.8789,    -0.5428,    -0.1114,     0.3399,     0.8754,      1.354,     0.2952, }, // 14
   {      -3.67,     -3.784,     -3.593,     -3.435,      -3.16,     -2.871,     -2.501,     -2.282,     -2.137,     -1.865,     -1.605,      -1.29,    -0.9421,    -0.5068,     0.2952,      1.328, }, // 15
 };

static double Conf_S_ij[16][16] = {
   {      1.048,     -2.921,     -3.292,     -3.022,     -2.459,     -2.978,      -2.93,    -0.9572,       -1.8,     -2.193,     -3.103,    -0.3403,     -2.029,     -2.839,      -2.84,      -3.19, }, // 0
   {     -2.921,      1.825,     0.9252,     0.3069,     -1.374,     0.4492,     -1.693,     -3.676,     -3.448,     -2.493,     0.4514,     -2.817,     -3.941,     -1.162,     -2.227,     -3.248, }, // 1
   {     -3.292,     0.9252,      2.362,     -1.263,     -2.185,    -0.2291,     -2.822,     -5.114,     -4.562,     -3.709,     -1.122,     -4.078,      -4.67,     -2.643,      -3.63,      -4.62, }, // 2
   {     -3.022,     0.3069,     -1.263,      2.283,     0.3484,     0.5439,     -1.065,     -2.015,     -1.715,     -1.605,    -0.1588,     -1.161,     -2.027,     0.6605,     0.3705,     -2.263, }, // 3
   {     -2.459,     -1.374,     -2.185,     0.3484,      2.423,     0.5688,     -1.041,     -2.475,     0.7541,      -2.04,     -1.105,    -0.1972,    -0.6986,    -0.4027,     0.1818,     -1.676, }, // 4
   {     -2.978,     0.4492,    -0.2291,     0.5439,     0.5688,      2.514,     -1.474,     -3.138,     -1.767,     -2.567,    -0.3553,     -1.587,     -2.479,    -0.9697,    -0.9455,     -2.751, }, // 5
   {      -2.93,     -1.693,     -2.822,     -1.065,     -1.041,     -1.474,      2.617,     -1.646,     0.1298,     0.2876,       1.06,     -2.221,     -2.193,   -0.04687,    -0.3805,    -0.9076, }, // 6
   {    -0.9572,     -3.676,     -5.114,     -2.015,     -2.475,     -3.138,     -1.646,      2.757,     -1.773,     -0.578,     -2.201,    -0.7486,     -1.687,    -0.7126,    -0.3351,     -0.653, }, // 7
   {       -1.8,     -3.448,     -4.562,     -1.715,     0.7541,     -1.767,     0.1298,     -1.773,      2.488,    -0.4196,     -1.469,    -0.4539,      0.619,     -1.281,    0.03803, -5.324e-06, }, // 8
   {     -2.193,     -2.493,     -3.709,     -1.605,      -2.04,     -2.567,     0.2876,     -0.578,    -0.4196,      2.717,     -1.098,     -1.977,     -2.092,     0.7113,    -0.8844,      1.193, }, // 9
   {     -3.103,     0.4514,     -1.122,    -0.1588,     -1.105,    -0.3553,       1.06,     -2.201,     -1.469,     -1.098,       2.62,     -2.356,     -3.087,   -0.04643,     -1.072,     -1.738, }, // 10
   {    -0.3403,     -2.817,     -4.078,     -1.161,    -0.1972,     -1.587,     -2.221,    -0.7486,    -0.4539,     -1.977,     -2.356,      2.348,     0.2403,    -0.4356,    -0.1217,     -2.044, }, // 11
   {     -2.029,     -3.941,      -4.67,     -2.027,    -0.6986,     -2.479,     -2.193,     -1.687,      0.619,     -2.092,     -3.087,     0.2403,       3.01,     -1.489,     0.5632,     0.4504, }, // 12
   {     -2.839,     -1.162,     -2.643,     0.6605,    -0.4027,    -0.9697,   -0.04687,    -0.7126,     -1.281,     0.7113,   -0.04643,    -0.4356,     -1.489,      2.738,      0.209,     -0.326, }, // 13
   {      -2.84,     -2.227,      -3.63,     0.3705,     0.1818,    -0.9455,    -0.3805,    -0.3351,    0.03803,    -0.8844,     -1.072,    -0.1217,     0.5632,      0.209,      2.736,    -0.1893, }, // 14
   {      -3.19,     -3.248,      -4.62,     -2.263,     -1.676,     -2.751,    -0.9076,     -0.653, -5.324e-06,      1.193,     -1.738,     -2.044,     0.4504,     -0.326,    -0.1893,      3.202, }, // 15
 };

static double NENConf_S_ij[16][16] = {
   {     0.8518,     -1.348,     -1.504,     -1.261,      -1.12,     -1.334,     -1.295,    -0.2256,    -0.7107,    -0.7126,     -1.432,    -0.2992,    -0.6039,     -1.167,     -1.061,    -0.9396, }, // 0
   {     -1.348,      1.309,       0.61,    0.06016,      -0.53,     0.3132,    -0.5315,     -1.497,     -1.185,    -0.8258,     0.3011,     -1.217,     -1.077,     -0.528,     -0.748,    -0.9624, }, // 1
   {     -1.504,       0.61,       1.77,    -0.6611,    -0.8862,    0.02405,     -1.038,      -1.86,     -1.572,     -1.154,    -0.4244,     -1.687,     -1.445,      -1.07,     -1.164,      -1.35, }, // 2
   {     -1.261,    0.06016,    -0.6611,      1.852,     0.3891,     0.4304,    -0.3022,     -1.061,     -0.332,    -0.7179,     0.0477,    -0.6467,    -0.4648,     0.4587,      0.313,    -0.7614, }, // 3
   {      -1.12,      -0.53,    -0.8862,     0.3891,      1.981,     0.5257,    -0.2399,     -1.157,     0.4659,    -0.5518,    -0.4633,    0.01265,     0.1901,    -0.2528,     0.3335,    -0.5161, }, // 4
   {     -1.334,     0.3132,    0.02405,     0.4304,     0.5257,      2.031,    -0.5536,     -1.332,    -0.5164,    -0.8447,    -0.2173,    -0.7168,    -0.6949,     -0.562,    -0.2936,    -0.9416, }, // 5
   {     -1.295,    -0.5315,     -1.038,    -0.3022,    -0.2399,    -0.5536,      2.311,    -0.4242,    -0.1153,     0.5394,     0.7381,    -0.7304,    -0.5932,      0.337,    -0.1002,     0.2327, }, // 6
   {    -0.2256,     -1.497,      -1.86,     -1.061,     -1.157,     -1.332,    -0.4242,      2.251,    -0.5042,     0.2254,     -1.002,     -0.303,    -0.6589,    -0.5139,    -0.2097,    -0.1129, }, // 7
   {    -0.7107,     -1.185,     -1.572,     -0.332,     0.4659,    -0.5164,    -0.1153,    -0.5042,      2.184,    -0.2252,    -0.6532,    0.07781,     0.6819,    -0.4411,     0.2796,     0.1585, }, // 8
   {    -0.7126,    -0.8258,     -1.154,    -0.7179,    -0.5518,    -0.8447,     0.5394,     0.2254,    -0.2252,      2.101,    -0.3143,    -0.6016,    -0.6928,     0.3562,    -0.1633,     0.7433, }, // 9
   {     -1.432,     0.3011,    -0.4244,     0.0477,    -0.4633,    -0.2173,     0.7381,     -1.002,    -0.6532,    -0.3143,      2.198,     -1.165,     -1.113,     0.2472,     -0.448,    -0.4024, }, // 10
   {    -0.2992,     -1.217,     -1.687,    -0.6467,    0.01265,    -0.7168,    -0.7304,     -0.303,    0.07781,    -0.6016,     -1.165,      1.872,     0.0271,    -0.4306,    -0.1747,    -0.7465, }, // 11
   {    -0.6039,     -1.077,     -1.445,    -0.4648,     0.1901,    -0.6949,    -0.5932,    -0.6589,     0.6819,    -0.6928,     -1.113,     0.0271,      2.467,    -0.6941,     0.3074,     0.1741, }, // 12
   {     -1.167,     -0.528,      -1.07,     0.4587,    -0.2528,     -0.562,      0.337,    -0.5139,    -0.4411,     0.3562,     0.2472,    -0.4306,    -0.6941,      2.199,     0.5542,   -0.09409, }, // 13
   {     -1.061,     -0.748,     -1.164,      0.313,     0.3335,    -0.2936,    -0.1002,    -0.2097,     0.2796,    -0.1633,     -0.448,    -0.1747,     0.3074,     0.5542,      2.355,    0.04401, }, // 14
   {    -0.9396,    -0.9624,      -1.35,    -0.7614,    -0.5161,    -0.9416,     0.2327,    -0.1129,     0.1585,     0.7433,    -0.4024,    -0.7465,     0.1741,   -0.09409,    0.04401,       2.52, }, // 15
 };

static double RENDist_S_ij[16][16] = {
   {       3.05,       1.46,     0.1157,    -0.8224,     -1.452,     -2.722,     -2.474,     -2.607,      -2.64,     -2.782,     -3.149,     -3.392,     -3.708,     -3.879,     -3.893,     -3.831, }, // 0
   {       1.46,      2.719,      1.796,     0.5287,    -0.3827,     -1.839,     -1.371,     -1.651,     -1.893,     -2.134,     -2.325,     -2.936,     -3.078,     -3.197,     -3.427,     -3.228, }, // 1
   {     0.1157,      1.796,        2.2,      1.304,     0.1968,     -1.428,    -0.8939,     -1.307,     -1.612,     -1.936,     -2.134,      -2.36,     -2.688,     -2.939,     -3.371,     -3.381, }, // 2
   {    -0.8224,     0.5287,      1.304,       1.71,     0.9934,    -0.8316,    -0.4504,    -0.9273,     -1.315,     -1.607,      -1.96,      -2.29,     -2.525,     -2.794,     -3.206,      -3.36, }, // 3
   {     -1.452,    -0.3827,     0.1968,     0.9934,      1.483,    -0.1339,     0.1191,    -0.4703,    -0.9192,     -1.322,     -1.624,     -1.955,     -2.275,     -2.517,     -2.951,     -3.191, }, // 4
   {     -2.722,     -1.839,     -1.428,    -0.8316,    -0.1339,     0.9252,    0.05006,    -0.6542,     -1.111,     -1.386,     -1.472,     -1.468,     -1.478,     -1.337,     -1.242,    -0.5264, }, // 5
   {     -2.474,     -1.371,    -0.8939,    -0.4504,     0.1191,    0.05006,       1.55,      1.144,     0.4091,    -0.1744,    -0.5843,     -1.002,     -1.322,     -1.649,     -2.184,     -2.471, }, // 6
   {     -2.607,     -1.651,     -1.307,    -0.9273,    -0.4703,    -0.6542,      1.144,      1.601,      1.192,        0.5,   -0.02914,    -0.4649,     -0.821,      -1.23,     -1.779,     -2.178, }, // 7
   {      -2.64,     -1.893,     -1.612,     -1.315,    -0.9192,     -1.111,     0.4091,      1.192,      1.669,      1.289,      0.622,    0.08007,    -0.2848,    -0.7204,     -1.207,     -1.814, }, // 8
   {     -2.782,     -2.134,     -1.936,     -1.607,     -1.322,     -1.386,    -0.1744,        0.5,      1.289,      1.713,      1.347,     0.7461,     0.2696,    -0.1723,    -0.7903,     -1.447, }, // 9
   {     -3.149,     -2.325,     -2.134,      -1.96,     -1.624,     -1.472,    -0.5843,   -0.02914,      0.622,      1.347,      1.799,      1.497,     0.8917,     0.3887,    -0.3434,     -1.026, }, // 10
   {     -3.392,     -2.936,      -2.36,      -2.29,     -1.955,     -1.468,     -1.002,    -0.4649,    0.08007,     0.7461,      1.497,      1.877,      1.524,     0.9461,     0.1417,    -0.6199, }, // 11
   {     -3.708,     -3.078,     -2.688,     -2.525,     -2.275,     -1.478,     -1.322,     -0.821,    -0.2848,     0.2696,     0.8917,      1.524,      1.871,      1.571,     0.6871,    -0.2316, }, // 12
   {     -3.879,     -3.197,     -2.939,     -2.794,     -2.517,     -1.337,     -1.649,      -1.23,    -0.7204,    -0.1723,     0.3887,     0.9461,      1.571,      1.949,      1.335,      0.245, }, // 13
   {     -3.893,     -3.427,     -3.371,     -3.206,     -2.951,     -1.242,     -2.184,     -1.779,     -1.207,    -0.7903,    -0.3434,     0.1417,     0.6871,      1.335,      1.837,     0.7974, }, // 14
   {     -3.831,     -3.228,     -3.381,      -3.36,     -3.191,    -0.5264,     -2.471,     -2.178,     -1.814,     -1.447,     -1.026,    -0.6199,    -0.2316,      0.245,     0.7974,      1.494, }, // 15
 };

static double DstNxtHlx_S_ij[16][16] = {
   {     0.9963,     -1.243,      -1.85,      -2.06,      -2.15,     -2.255,     -2.193,     -2.164,     -2.153,     -1.984,     -2.049,     -2.117,     -2.039,     -1.902,     -1.739,     -1.535, }, // 0
   {     -1.243,      4.324,       3.28,      2.197,      1.982,      1.636,      0.965,     0.1362,    -0.3939,    -0.8754,     -1.246,     -1.405,     -1.398,     -1.416,     -1.528,     -1.983, }, // 1
   {      -1.85,       3.28,      3.458,      2.715,      1.844,      1.523,      1.163,     0.5238,    -0.0747,     -0.653,     -1.017,     -1.171,     -1.121,     -1.176,     -1.305,     -2.021, }, // 2
   {      -2.06,      2.197,      2.715,      3.125,      2.357,      1.615,      1.243,     0.8463,     0.3271,    -0.2894,    -0.7408,     -1.032,     -1.176,     -1.343,     -1.417,     -2.009, }, // 3
   {      -2.15,      1.982,      1.844,      2.357,      2.622,      2.019,      1.305,     0.9662,     0.6095,   0.008757,     -0.497,    -0.8823,     -1.154,     -1.291,     -1.485,     -1.956, }, // 4
   {     -2.255,      1.636,      1.523,      1.615,      2.019,      2.265,      1.775,      1.116,     0.7094,     0.2323,     -0.138,    -0.6357,     -0.999,     -1.227,      -1.38,     -1.879, }, // 5
   {     -2.193,      0.965,      1.163,      1.243,      1.305,      1.775,      2.075,      1.568,     0.9539,     0.4523,     0.1601,    -0.3626,    -0.9567,     -1.266,     -1.483,     -1.838, }, // 6
   {     -2.164,     0.1362,     0.5238,     0.8463,     0.9662,      1.116,      1.568,      1.927,      1.469,     0.7431,      0.389,   -0.02157,    -0.6756,     -1.113,     -1.323,     -1.785, }, // 7
   {     -2.153,    -0.3939,    -0.0747,     0.3271,     0.6095,     0.7094,     0.9539,      1.469,       1.81,      1.239,     0.7144,     0.2428,    -0.3682,    -0.9863,     -1.324,     -1.696, }, // 8
   {     -1.984,    -0.8754,     -0.653,    -0.2894,   0.008757,     0.2323,     0.4523,     0.7431,      1.239,      1.642,      1.228,     0.5405,   -0.04119,    -0.7677,      -1.17,     -1.444, }, // 9
   {     -2.049,     -1.246,     -1.017,    -0.7408,     -0.497,     -0.138,     0.1601,      0.389,     0.7144,      1.228,      1.642,       1.02,     0.2774,    -0.4619,     -1.085,     -1.471, }, // 10
   {     -2.117,     -1.405,     -1.171,     -1.032,    -0.8823,    -0.6357,    -0.3626,   -0.02157,     0.2428,     0.5405,       1.02,      1.518,     0.9484,     0.0892,    -0.8157,     -1.341, }, // 11
   {     -2.039,     -1.398,     -1.121,     -1.176,     -1.154,     -0.999,    -0.9567,    -0.6756,    -0.3682,   -0.04119,     0.2774,     0.9484,      1.618,     0.8576,    -0.2861,     -1.098, }, // 12
   {     -1.902,     -1.416,     -1.176,     -1.343,     -1.291,     -1.227,     -1.266,     -1.113,    -0.9863,    -0.7677,    -0.4619,     0.0892,     0.8576,      1.551,     0.8028,    -0.6108, }, // 13
   {     -1.739,     -1.528,     -1.305,     -1.417,     -1.485,      -1.38,     -1.483,     -1.323,     -1.324,      -1.17,     -1.085,    -0.8157,    -0.2861,     0.8028,      1.681,     0.3461, }, // 14
   {     -1.535,     -1.983,     -2.021,     -2.009,     -1.956,     -1.879,     -1.838,     -1.785,     -1.696,     -1.444,     -1.471,     -1.341,     -1.098,    -0.6108,     0.3461,      1.377, }, // 15
 };

static double StrandDens_S_ij[16][16] = {
   {      1.384,     0.2691,     -1.601,     -2.661,     -3.276,      -3.69,     -4.015,     -4.176,     -4.553,     -4.701,     -5.148,     -5.505,     -6.236,     -6.648,     -8.496,     -2.834, }, // 0
   {     0.2691,      1.219,     0.5335,    -0.4214,     -1.054,      -1.47,     -1.856,     -2.212,     -2.636,     -3.034,      -3.49,     -4.056,      -4.77,      -5.47,     -6.882,     -3.093, }, // 1
   {     -1.601,     0.5335,      1.313,     0.9788,     0.4539,   0.004853,    -0.4174,    -0.8378,     -1.285,     -1.763,      -2.29,      -2.88,     -3.599,     -4.523,     -5.469,     -2.859, }, // 2
   {     -2.661,    -0.4214,     0.9788,       1.37,      1.185,     0.8254,     0.3976,   -0.03032,    -0.5012,     -1.008,     -1.564,     -2.241,     -3.123,      -4.08,     -5.156,      -2.72, }, // 3
   {     -3.276,     -1.054,     0.4539,      1.185,      1.416,      1.269,      0.958,     0.5571,     0.1513,    -0.3708,    -0.9441,     -1.613,     -2.465,     -3.482,      -4.73,     -2.758, }, // 4
   {      -3.69,      -1.47,   0.004853,     0.8254,      1.269,      1.385,      1.255,      0.981,     0.6295,     0.1187,    -0.4492,     -1.149,     -2.015,     -3.037,     -4.233,      -2.76, }, // 5
   {     -4.015,     -1.856,    -0.4174,     0.3976,      0.958,      1.255,      1.375,      1.258,      1.001,     0.5763,    0.01556,    -0.6921,     -1.537,     -2.545,     -3.607,     -2.828, }, // 6
   {     -4.176,     -2.212,    -0.8378,   -0.03032,     0.5571,      0.981,      1.258,      1.378,       1.27,      0.944,     0.4757,     -0.202,     -1.022,     -2.008,     -3.138,     -2.724, }, // 7
   {     -4.553,     -2.636,     -1.285,    -0.5012,     0.1513,     0.6295,      1.001,       1.27,      1.376,      1.209,     0.8533,      0.261,    -0.5037,     -1.434,     -2.498,     -2.642, }, // 8
   {     -4.701,     -3.034,     -1.763,     -1.008,    -0.3708,     0.1187,     0.5763,      0.944,      1.209,      1.323,       1.17,      0.723,    0.05037,    -0.8174,     -1.822,     -2.422, }, // 9
   {     -5.148,      -3.49,      -2.29,     -1.564,    -0.9441,    -0.4492,    0.01556,     0.4757,     0.8533,       1.17,      1.311,      1.108,     0.6275,     -0.141,     -1.056,     -2.092, }, // 10
   {     -5.505,     -4.056,      -2.88,     -2.241,     -1.613,     -1.149,    -0.6921,     -0.202,      0.261,      0.723,      1.108,      1.265,      1.097,     0.5597,    -0.2164,     -1.418, }, // 11
   {     -6.236,      -4.77,     -3.599,     -3.123,     -2.465,     -2.015,     -1.537,     -1.022,    -0.5037,    0.05037,     0.6275,      1.097,      1.372,      1.217,     0.6563,    -0.5927, }, // 12
   {     -6.648,      -5.47,     -4.523,      -4.08,     -3.482,     -3.037,     -2.545,     -2.008,     -1.434,    -0.8174,     -0.141,     0.5597,      1.217,      1.605,      1.448,     0.4322, }, // 13
   {     -8.496,     -6.882,     -5.469,     -5.156,      -4.73,     -4.233,     -3.607,     -3.138,     -2.498,     -1.822,     -1.056,    -0.2164,     0.6563,      1.448,      1.894,      1.487, }, // 14
   {     -2.834,     -3.093,     -2.859,      -2.72,     -2.758,      -2.76,     -2.828,     -2.724,     -2.642,     -2.422,     -2.092,     -1.418,    -0.5927,     0.4322,      1.487,      2.325, }, // 15
 };

static double NormDens_S_ij[16][16] = {
   {      1.619,     0.8131,   -0.06952,    -0.8142,     -1.513,      -2.08,     -2.558,     -2.957,     -3.259,     -3.657,     -3.997,     -4.246,     -4.737,     -5.059,     -5.757,    -0.8663, }, // 0
   {     0.8131,      1.429,     0.9792,     0.3429,    -0.2883,    -0.8937,     -1.428,     -1.934,     -2.316,     -2.734,     -3.012,     -3.318,     -3.765,     -4.132,     -4.668,     -2.197, }, // 1
   {   -0.06952,     0.9792,      1.261,     0.9351,     0.4025,    -0.1679,    -0.6851,     -1.201,     -1.666,     -2.062,     -2.447,     -2.805,     -3.321,     -3.768,     -4.188,     -2.952, }, // 2
   {    -0.8142,     0.3429,     0.9351,      1.191,      0.959,     0.4678,   -0.03876,    -0.5344,     -1.025,     -1.431,     -1.873,     -2.234,     -2.729,     -3.151,     -3.687,     -3.317, }, // 3
   {     -1.513,    -0.2883,     0.4025,      0.959,      1.208,     0.9804,     0.5281,    0.05734,    -0.4122,    -0.8424,     -1.308,     -1.732,     -2.241,     -2.704,     -3.236,     -3.513, }, // 4
   {      -2.08,    -0.8937,    -0.1679,     0.4678,     0.9804,      1.175,     0.9685,     0.5566,     0.1149,    -0.3269,    -0.7905,     -1.259,     -1.748,     -2.182,     -2.756,     -3.409, }, // 5
   {     -2.558,     -1.428,    -0.6851,   -0.03876,     0.5281,     0.9685,      1.156,     0.9738,      0.619,     0.1996,    -0.2837,    -0.7805,     -1.287,     -1.824,     -2.291,     -3.067, }, // 6
   {     -2.957,     -1.934,     -1.201,    -0.5344,    0.05734,     0.5566,     0.9738,      1.148,       1.01,     0.6507,     0.1842,    -0.3137,    -0.8392,     -1.359,     -1.908,     -2.858, }, // 7
   {     -3.259,     -2.316,     -1.666,     -1.025,    -0.4122,     0.1149,      0.619,       1.01,      1.221,      1.068,     0.6843,     0.2027,     -0.316,    -0.8522,     -1.455,     -2.404, }, // 8
   {     -3.657,     -2.734,     -2.062,     -1.431,    -0.8424,    -0.3269,     0.1996,     0.6507,      1.068,      1.256,      1.099,     0.6818,     0.1492,    -0.4102,     -1.014,     -1.999, }, // 9
   {     -3.997,     -3.012,     -2.447,     -1.873,     -1.308,    -0.7905,    -0.2837,     0.1842,     0.6843,      1.099,      1.312,      1.147,      0.688,     0.1269,    -0.5066,     -1.572, }, // 10
   {     -4.246,     -3.318,     -2.805,     -2.234,     -1.732,     -1.259,    -0.7805,    -0.3137,     0.2027,     0.6818,      1.147,      1.405,      1.215,     0.7237,    0.07235,    -0.9662, }, // 11
   {     -4.737,     -3.765,     -3.321,     -2.729,     -2.241,     -1.748,     -1.287,    -0.8392,     -0.316,     0.1492,      0.688,      1.215,       1.52,      1.335,     0.7046,     -0.423, }, // 12
   {     -5.059,     -4.132,     -3.768,     -3.151,     -2.704,     -2.182,     -1.824,     -1.359,    -0.8522,    -0.4102,     0.1269,     0.7237,      1.335,      1.762,      1.492,     0.3147, }, // 13
   {     -5.757,     -4.668,     -4.188,     -3.687,     -3.236,     -2.756,     -2.291,     -1.908,     -1.455,     -1.014,    -0.5066,    0.07235,     0.7046,      1.492,      2.053,      1.291, }, // 14
   {    -0.8663,     -2.197,     -2.952,     -3.317,     -3.513,     -3.409,     -3.067,     -2.858,     -2.404,     -1.999,     -1.572,    -0.9662,     -0.423,     0.3147,      1.291,      2.277, }, // 15
 };

float **g_ScoreMxs2[FEATURE_COUNT];
uint g_AlphaSizes2[FEATURE_COUNT];

// use iff leak detection
static void FreeMe();

static bool Init()
	{
	//atexit(FreeMe); // use iff leak detection
	asserta(DSSParams::GetAlphaSize(FEATURE_AA) == 20);
	asserta(DSSParams::GetAlphaSize(FEATURE_NENDist) == 16);
	asserta(DSSParams::GetAlphaSize(FEATURE_Conf) == 16);
	asserta(DSSParams::GetAlphaSize(FEATURE_NENConf) == 16);
	asserta(DSSParams::GetAlphaSize(FEATURE_RENDist) == 16);
	asserta(DSSParams::GetAlphaSize(FEATURE_DstNxtHlx) == 16);
	asserta(DSSParams::GetAlphaSize(FEATURE_StrandDens) == 16);
	asserta(DSSParams::GetAlphaSize(FEATURE_NormDens) == 16);

	g_AlphaSizes2[FEATURE_AA] = 20;
	g_AlphaSizes2[FEATURE_NENDist] = 16;
	g_AlphaSizes2[FEATURE_Conf] = 16;
	g_AlphaSizes2[FEATURE_NENConf] = 16;
	g_AlphaSizes2[FEATURE_RENDist] = 16;
	g_AlphaSizes2[FEATURE_DstNxtHlx] = 16;
	g_AlphaSizes2[FEATURE_StrandDens] = 16;
	g_AlphaSizes2[FEATURE_NormDens] = 16;

	g_ScoreMxs2[FEATURE_AA] = myalloc(float *, 20);
	for (uint i = 0; i < 20; ++i)
		{
		g_ScoreMxs2[FEATURE_AA][i] = myalloc(float, 20);
		for (uint j = 0; j < 20; ++j)
			{
			g_ScoreMxs2[FEATURE_AA][i][j] = (float) AA_S_ij[i][j];
			}
		}
	g_ScoreMxs2[FEATURE_NENDist] = myalloc(float *, 16);
	for (uint i = 0; i < 16; ++i)
		{
		g_ScoreMxs2[FEATURE_NENDist][i] = myalloc(float, 16);
		for (uint j = 0; j < 16; ++j)
			{
			g_ScoreMxs2[FEATURE_NENDist][i][j] = (float) NENDist_S_ij[i][j];
			}
		}
	g_ScoreMxs2[FEATURE_Conf] = myalloc(float *, 16);
	for (uint i = 0; i < 16; ++i)
		{
		g_ScoreMxs2[FEATURE_Conf][i] = myalloc(float, 16);
		for (uint j = 0; j < 16; ++j)
			{
			g_ScoreMxs2[FEATURE_Conf][i][j] = (float) Conf_S_ij[i][j];
			}
		}
	g_ScoreMxs2[FEATURE_NENConf] = myalloc(float *, 16);
	for (uint i = 0; i < 16; ++i)
		{
		g_ScoreMxs2[FEATURE_NENConf][i] = myalloc(float, 16);
		for (uint j = 0; j < 16; ++j)
			{
			g_ScoreMxs2[FEATURE_NENConf][i][j] = (float) NENConf_S_ij[i][j];
			}
		}
	g_ScoreMxs2[FEATURE_RENDist] = myalloc(float *, 16);
	for (uint i = 0; i < 16; ++i)
		{
		g_ScoreMxs2[FEATURE_RENDist][i] = myalloc(float, 16);
		for (uint j = 0; j < 16; ++j)
			{
			g_ScoreMxs2[FEATURE_RENDist][i][j] = (float) RENDist_S_ij[i][j];
			}
		}
	g_ScoreMxs2[FEATURE_DstNxtHlx] = myalloc(float *, 16);
	for (uint i = 0; i < 16; ++i)
		{
		g_ScoreMxs2[FEATURE_DstNxtHlx][i] = myalloc(float, 16);
		for (uint j = 0; j < 16; ++j)
			{
			g_ScoreMxs2[FEATURE_DstNxtHlx][i][j] = (float) DstNxtHlx_S_ij[i][j];
			}
		}
	g_ScoreMxs2[FEATURE_StrandDens] = myalloc(float *, 16);
	for (uint i = 0; i < 16; ++i)
		{
		g_ScoreMxs2[FEATURE_StrandDens][i] = myalloc(float, 16);
		for (uint j = 0; j < 16; ++j)
			{
			g_ScoreMxs2[FEATURE_StrandDens][i][j] = (float) StrandDens_S_ij[i][j];
			}
		}
	g_ScoreMxs2[FEATURE_NormDens] = myalloc(float *, 16);
	for (uint i = 0; i < 16; ++i)
		{
		g_ScoreMxs2[FEATURE_NormDens][i] = myalloc(float, 16);
		for (uint j = 0; j < 16; ++j)
			{
			g_ScoreMxs2[FEATURE_NormDens][i][j] = (float) NormDens_S_ij[i][j];
			}
		}
	return true;
	}
static bool InitDone = Init();

// used iff leak detection
static void FreeMe()
	{
	for (uint F = 0; F < FEATURE_COUNT; ++F)
		{
		if (g_ScoreMxs2[F] != 0)
			{
			uint AS = g_AlphaSizes2[F];
			for (uint i = 0; i < AS; ++i)
				myfree(g_ScoreMxs2[F][i]);
			myfree(g_ScoreMxs2[F]);
			}
		}
	}

void DSSParams::OverwriteUnweightedScoreMx(FEATURE F,
	vector<vector<float> > &ScoreMx)
	{
	asserta(g_ScoreMxs2[F] != 0);
	const uint AS = g_AlphaSizes2[F];
	asserta(SIZE(ScoreMx) == AS);
	for (uint i = 0; i < AS; ++i)
		{
		const vector<float> &Row = ScoreMx[i];
		asserta(SIZE(Row) == AS);
		for (uint j = 0; j < AS; ++j)
			g_ScoreMxs2[F][i][j] = ScoreMx[i][j];
		}
	}
